

"""
Legacy module for PKCS#1 PSS signatures.

:undocumented: __package__
"""

import types

from Crypto.Signature import pss


def _pycrypto_verify(self, hash_object, signature):
    try:
        self._verify(hash_object, signature)
    except (ValueError, TypeError):
        return False
    return True


def new(rsa_key, mgfunc=None, saltLen=None, randfunc=None):
    pkcs1 = pss.new(rsa_key, mask_func=mgfunc,
                    salt_bytes=saltLen, rand_func=randfunc)
    pkcs1._verify = pkcs1.verify
    pkcs1.verify = types.MethodType(_pycrypto_verify, pkcs1)
    return pkcs1
